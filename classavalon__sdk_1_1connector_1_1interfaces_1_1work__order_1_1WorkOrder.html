<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Hyperledger Avalon: avalon_sdk.connector.interfaces.work_order.WorkOrder Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="HL_Avalon_Logo_Color_Small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Hyperledger Avalon
   &#160;<span id="projectnumber">0.5.0.dev1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>avalon_sdk</b></li><li class="navelem"><b>connector</b></li><li class="navelem"><b>interfaces</b></li><li class="navelem"><b>work_order</b></li><li class="navelem"><a class="el" href="classavalon__sdk_1_1connector_1_1interfaces_1_1work__order_1_1WorkOrder.html">WorkOrder</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classavalon__sdk_1_1connector_1_1interfaces_1_1work__order_1_1WorkOrder-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">avalon_sdk.connector.interfaces.work_order.WorkOrder Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for avalon_sdk.connector.interfaces.work_order.WorkOrder:</div>
<div class="dyncontent">
<div class="center"><img src="classavalon__sdk_1_1connector_1_1interfaces_1_1work__order_1_1WorkOrder__inherit__graph.png" border="0" usemap="#avalon__sdk_8connector_8interfaces_8work__order_8WorkOrder_inherit__map" alt="Inheritance graph"/></div>
<map name="avalon__sdk_8connector_8interfaces_8work__order_8WorkOrder_inherit__map" id="avalon__sdk_8connector_8interfaces_8work__order_8WorkOrder_inherit__map">
<area shape="rect" id="node3" href="classavalon__sdk_1_1connector_1_1direct_1_1jrpc_1_1jrpc__work__order_1_1JRPCWorkOrderImpl.html" title="avalon_sdk.connector.direct.jrpc.jrpc\l_work_order.JRPCWorkOrderImpl" alt="" coords="399,5,633,47"/>
<area shape="rect" id="node4" href="classavalon__sdk_1_1connector_1_1interfaces_1_1work__order__proxy_1_1WorkOrderProxy.html" title="avalon_sdk.connector.interfaces.work\l_order_proxy.WorkOrderProxy" alt="" coords="395,71,637,112"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for avalon_sdk.connector.interfaces.work_order.WorkOrder:</div>
<div class="dyncontent">
<div class="center"><img src="classavalon__sdk_1_1connector_1_1interfaces_1_1work__order_1_1WorkOrder__coll__graph.png" border="0" usemap="#avalon__sdk_8connector_8interfaces_8work__order_8WorkOrder_coll__map" alt="Collaboration graph"/></div>
<map name="avalon__sdk_8connector_8interfaces_8work__order_8WorkOrder_coll__map" id="avalon__sdk_8connector_8interfaces_8work__order_8WorkOrder_coll__map">
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ab0092a12db179b1a6fb9382ffbf79539"><td class="memItemLeft" align="right" valign="top"><a id="ab0092a12db179b1a6fb9382ffbf79539"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><b>__init__</b> (self)</td></tr>
<tr class="separator:ab0092a12db179b1a6fb9382ffbf79539"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea6e59d06a08e5ab0c3fdea6650fd453"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classavalon__sdk_1_1connector_1_1interfaces_1_1work__order_1_1WorkOrder.html#aea6e59d06a08e5ab0c3fdea6650fd453">work_order_submit</a> (self, work_order_id, worker_id, requester_id, work_order_request, id=None)</td></tr>
<tr class="separator:aea6e59d06a08e5ab0c3fdea6650fd453"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7a0339a6048e7c2d91792a5cf293a3e"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classavalon__sdk_1_1connector_1_1interfaces_1_1work__order_1_1WorkOrder.html#ad7a0339a6048e7c2d91792a5cf293a3e">work_order_get_result</a> (self, work_order_id, id=None)</td></tr>
<tr class="separator:ad7a0339a6048e7c2d91792a5cf293a3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4d58707bfa32df53e0dbb19083b31f9"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classavalon__sdk_1_1connector_1_1interfaces_1_1work__order_1_1WorkOrder.html#ad4d58707bfa32df53e0dbb19083b31f9">encryption_key_get</a> (self, worker_id, requester_id, last_used_key_nonce=None, tag=None, signature_nonce=None, signature=None, id=None)</td></tr>
<tr class="separator:ad4d58707bfa32df53e0dbb19083b31f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a5014cbe6b89cce35d11fade8cb94b1"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classavalon__sdk_1_1connector_1_1interfaces_1_1work__order_1_1WorkOrder.html#a3a5014cbe6b89cce35d11fade8cb94b1">encryption_key_set</a> (self, worker_id, encryption_key, encryption_nonce, tag, signature, id=None)</td></tr>
<tr class="separator:a3a5014cbe6b89cce35d11fade8cb94b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">This class is an abstract base class that contains
abstract APIs to manage work orders.
</pre> </div><h2 class="groupheader">Member Function Documentation</h2>
<a id="ad4d58707bfa32df53e0dbb19083b31f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4d58707bfa32df53e0dbb19083b31f9">&#9670;&nbsp;</a></span>encryption_key_get()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def avalon_sdk.connector.interfaces.work_order.WorkOrder.encryption_key_get </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>worker_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>requester_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>last_used_key_nonce</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tag</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>signature_nonce</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>signature</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>id</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Get Encryption Key Request Payload.

Inputs
1. worker_id is an id of the worker to retrieve an encryption key for.
2. last_used_key_nonce is an optional nonce associated with the
last key retrieved.
If it is provided, the key retrieved should be newer than this one.
Otherwise any key can be retrieved.
3. tag is tag that should be associated with the returned key,
e.g. requester id. This is an optional parameter. If it is not
provided, requesterId below is used as a key.
4. requester_id is an id of the requester that plans to use the
returned key to submit one or more work orders using this key.
5. signature_nonce is an optional parameter and is used only
if signature below is also provided.
6. signature is an optional signature of workerId,
lastUsedKeyNonce, tag, and signatureNonce.
7. id is json rpc request id, it is optional
Output
1. errorCode is the result of the operation.
   1 - generic error
   2 - operation is not supported
   3 - invalid parameter
   4 - access denied
   5 - not ready, retry later. This is a recoverable error that may
   happen if the requester makes its first request for keys,
   or the requester retrieves keys, faster than the worker
   produces them.
   The requester should retry later.
2. worker_id is an id of the worker that created the encryption key.
3. encryptionKey is an encryption key.
4. encryptionKeyNonce is a nonce associated with the key.
5. tag is tag associated with the key.
6. signature is a signature generated by the worker.
</pre> 
</div>
</div>
<a id="a3a5014cbe6b89cce35d11fade8cb94b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a5014cbe6b89cce35d11fade8cb94b1">&#9670;&nbsp;</a></span>encryption_key_set()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def avalon_sdk.connector.interfaces.work_order.WorkOrder.encryption_key_set </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>worker_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>encryption_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>encryption_nonce</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>signature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>id</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Set encryption key request payload

Parameters:
worker_id        ID of the worker to retrieve an encryption key
encryption_key   Encryption key
encryption_nonce Nonce associated with the key
tag              Tag that should be associated with the returned key,
         e.g. requester id. This is an optional parameter.
         If it is not provided, requesterId below is used
         as a key
signature        Signature generated by the worker on the worker_id,
         tag, and encryption_nonce
id               Optional Optional JSON RPC request ID

Returns:
Error code is the result of the operation.
</pre> 
</div>
</div>
<a id="ad7a0339a6048e7c2d91792a5cf293a3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7a0339a6048e7c2d91792a5cf293a3e">&#9670;&nbsp;</a></span>work_order_get_result()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def avalon_sdk.connector.interfaces.work_order.WorkOrder.work_order_get_result </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>work_order_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>id</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Query blockchain to get a work order result.

If a Requester receives a response stating that its work order state
is "scheduled" or "processing", it should poll the Worker Service
later to get the result:
1. Poll the Worker Service periodically until the Work Order is
completed successfully or in error
2. Wait for the Work Order Receipt complete event and retrieve a final
result.

Parameters:
work_order_id Work Order ID that was sent in the
      corresponding work_order_submit request
id            Optional JSON RPC request ID

Returns:
Tuple containing work order status, worker id, work order request,
work order response, and error code.
None on error.
</pre> 
</div>
</div>
<a id="aea6e59d06a08e5ab0c3fdea6650fd453"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea6e59d06a08e5ab0c3fdea6650fd453">&#9670;&nbsp;</a></span>work_order_submit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def avalon_sdk.connector.interfaces.work_order.WorkOrder.work_order_submit </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>work_order_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>worker_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>requester_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>work_order_request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>id</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Submit a work order request.

Parameters:
work_order_id      Unique ID of the work order request
worker_id          Identifier for the worker
requester_id       Unique id to identify the requester
work_order_request JSON RPC string work order request.
           Defined in EEA specification 6.1.1.
id                 Optional JSON RPC request ID

Returns:
errorCode          0 on success and non-zero on error.

work_order_request is a JSON string containing following parameters:
{
    "responseTimeoutMSecs": &lt;integer&gt;,
    "payloadFormat": &lt;string&gt;
    "resultUri": &lt;string&gt;,
    "notifyUri": &lt;string&gt;,
    "workOrderId": &lt;hex string&gt;,
    "workerId": &lt;hex string or DID&gt;,
    "workloadId": &lt;hex string&gt;,
    "requesterId": &lt;hex string&gt;,
    "workerEncryptionKey": &lt;hex string&gt;,
    "dataEncryptionAlgorithm": &lt;string&gt;,
    "encryptedSessionKey": &lt;hex string&gt;,
    "sessionKeyIv": &lt;hex string&gt;,
    "requesterNonce": &lt;hex string&gt;,
    "encryptedRequestHash": &lt;hex string&gt;,
    "requesterSignature": &lt;BASE64 string&gt;,
},

1. responseTimeoutMSecs - is a maximum timeout in milliseconds that
the caller will wait for the response. Setting this timeout to zero
means that the work order is submitted in the asynchronous (resultUri
is present), notify (notifyUri is present), or poll mode (neither
resultUri nor notifyUri is present). In this case, the TCS should
schedule the request for execution and immediately return an error
response with error code set to "scheduled". If the timeout is not
zero, the work order is in synchronous mode. The TCS should wait for
the work order completion before returning the response to the
participant. If the request cannot be completed within the allocated
interval, the work order should be cancelled and a corresponding error
should be returned to the participant.
2. payloadFormat defines how signatures and data items are formatted in
this work order request and corresponding response.
3. resultUri is an optional parameter. If it is specified, the
WorkerService should submit the Work Order result to this URI.
See section Work Order Asynchronous Result.
4. notifyUri is an optional parameter. If it is specified, the
WorkerService should send an event to this URI upon the Work Order
completion.
5. workOrderId is an id assigned to the Work Order by the Requester
and can be registered using the Work Order Receipts API.
6. workerId is a worker id to process the work order,
e.g. an Ethereum address or its DID.
7. workloadId is an id of the workload to be executed by the worker.
It is an optional value if the worker includes a single workload.
8. requesterId is either the Requester’s Ethereum address or its DID.
9. workerEncryptionKey is an optional parameter containing the worker
encryption key used for this Work Order. It is useful if a Worker
frequently updates its encryption key in the registry and allows some
time overlap in utilizing multiple keys.
We assume here that the 'details' submitted during the registration of
a worker contain one or more public keys associated with the worker.
10. dataEncryptionAlgorithm is an optional parameter that defines an
algorithm for encrypting the data in this work order. The default is
the first value in the corresponding parameter for the worker
(defined by workerId). See section Common Data for All Worker Types.
11. encryptedSessionKey is a one-time encryption key generated by the
participant submitting the work order. It is sent encrypted with the
worker's public encryption key. It is used to encrypt
encryptedRequestHash and data item specific data encryption keys.
For the latter see Work Order Data Formats.
12. sessionKeyIv is an initialization vector if required by the data
encryption algorithm (encryptedSessionKey). The default is all zeros.
13. requesterNonce is a random string generated by the participant.
It is used to calculate a hash of this work order request.
14. encryptedRequestHash is a hash of the work order request encrypted
with the key provided in encryptedSessionKey.
15. requesterSignature is an optional parameter. See section
Work Order Signing for the details.
16. inData contains either a JWT of the specified data or an array of
one or more Work Order inputs, e.g. state, message containing input
parameters.
{
    "index": &lt;number&gt;,
    "dataHash": &lt;hex string&gt;,
    "data": &lt;BASE64 string&gt;,
    "encryptedDataEncryptionKey": &lt;hex string&gt;,
    "iv": &lt;hex string&gt;
}
i. index is an index that determines order of the data items for the
hash generation. It also can be used by the worker to identify
different inputs and outputs.
ii. dataHash is an optional hash value of the data. It is only
applicable to inData in the work order request and outData in the
response.
iii. data contains either data inline within the JSON document or a
reference (e.g. URI) to the data. It is up to the worker to determine
how to interpret the data content. This parameter is applicable to
    -&gt; inData in the work order request
    -&gt; outData in the request if it contains a reference for the output
    -&gt; outData in the response
iv. encryptedDataEncryptionKey defines if data are encrypted and what
key to use. It is included only in the work order request as one of the
options below.
If this key is not provided or set to "null" or to "", the data is
encrypted using encryptedSessionKey from the work order request.
If the key value is set to "-", the data item is not encrypted, a.k.a.
sent as clear text.
Otherwise, the data item is sent encrypted with a one-time encryption
key generated by a 3rd party that owns this data item (it may be
different from the work order requester).
encryptedDataEncryptionKey contains this encryption key in double
encrypted format.
First, it is encrypted with the worker's public encryption key (e.g. by
a 3rd party that owns the data so the requester cannot see the data).
Then the result of the previous encryption above is encrypted with the
key from encryptedSessionKey (by the requester to enforce the work
order integrity).
v. iv is an initialization vector if required by the data encryption
algorithm. The default is all zeros. If the same encryption key is
used to encrypt more than one data item or the hash value of the
work order request, the iv must be a unique random number for every
encryption operation. It is included only in the work order request.
17. outData contains information about what and how the work order
execution results should be delivered. Same as inData
18. id is used for json rpc request
</pre> 
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/home/dano/git/avalon/sdk/avalon_sdk/connector/interfaces/work_order.py</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
